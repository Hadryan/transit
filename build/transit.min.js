(function(){var e,t,n,r,i,s=function(e,t){return function(){return e.apply(t,arguments)}},o=[].slice;e=function(){function e(){this.drop=s(this.drop,this),this.set=s(this.set,this),this.get=s(this.get,this)}return e.prototype.view={},e.prototype.context={},e.prototype.tpl={},e.prototype.get=function(e,t){var n;return e=e.toLowerCase(),t=t.toLowerCase(),n=this[e][t],n===void 0?null:n},e.prototype.set=function(e,t,n){return e=e.toLowerCase(),t=t.toLowerCase(),this[e][t]=n},e.prototype.drop=function(e,t){return delete this[e][t],this},e}(),t={template_path:"/transit/views",asset_path:"/transit/assets"},n=function(){function e(){this.set=s(this.set,this),this.load=s(this.load,this),this.compile=s(this.compile,this)}return e.prototype.compile=function(e){return _.template(e)},e.prototype.load=function(e,t){var n,s=this;return n=r.cache.get("tpl",e),n!==void 0?t(n):$.get(""+i("template_path")+"/"+e,function(n){var i;return i=s.compile(n),r.cache.set("tpl",e,i),t(i)})},e.prototype.set=function(e,t){return typeof t=="string"&&(t=this.compile(t)),r.cache.set("tpl",e,t),this},e}(),r=this.Transit={},r.cache=new e,r.settings=t,r.template=new n,r.setup=function(e){return e==null&&(e={}),r.settings=_.extend(r.settings,e)},r.on=Backbone.Events.on,r.trigger=Backbone.Events.trigger,r.off=Backbone.Events.off,r.one=function(e,t,n){var i;return i=function(){var s;return s=1<=arguments.length?o.call(arguments,0):[],t.apply(null,s),r.off(e,i,n)},r.on(e,i,n)},r.set=r.cache.set,r.get=r.cache.get,r.init=function(e){return r.Manager.attach(e),r.trigger("init")},r.version="0.3.0",i=function(e){return r.settings[e]},this.Transit}).call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(){this.success=t(this.success,this),this.info=t(this.info,this),this.error=t(this.error,this)}return e.prototype.error=function(){},e.prototype.info=function(){},e.prototype.success=function(){},e}(),Transit.Notify=new e,typeof module!="undefined"&&module!==null&&(module.exports=Transit.Notify)}.call(this),function(){var e,t,n,r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t=function(){var e;return XMLHttpRequest===void 0?!1:(e=new XMLHttpRequest,e.upload===void 0?!1:e.upload.onprogress!==void 0)},n=function(){var e;return e=document.createElement("INPUT"),e.type="file",e.files!==void 0},e=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.tagName="div",n.prototype.className="transit-uploader",n["native"]=t(),n}(Backbone.View),Transit.Uploader=e,typeof module!="undefined"&&module!==null&&(module.exports=Transit.Uploader)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){return this._setType=t(this._setType,this),this._cleanup=t(this._cleanup,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.build_as="contexts_attributes",n.prototype.view=null,n.prototype.type=null,n.prototype._pendingDestroy=!1,n.prototype.initialize=function(){var e;return this._setType(),this.view===null&&(e=Transit.get("view",this.type),e===null&&(e=Transit.get("view","Context")),this.isNew()?this.view=new e({model:this}):this.view=new e({model:this,el:".managed-context[data-context-id='#{@id}']"})),this.on("change",function(e){var t,n,r;r=e.changes;for(t in r)n=r[t],this.view.trigger("change:"+t);return this.view.trigger("change")}),this.on("destroy",this.cleanup),this.view.render(),this},n.prototype._cleanup=function(){return this.view.remove(),delete this.view},n.prototype._setType=function(){return this.type!==null?!0:(this.has("_type")||this.set("_type",this.constructor.name),this.type=this.get("_type"))},n}(Backbone.Model),Transit.Context=e,typeof module!="undefined"&&module!==null&&(module.exports=Transit.Context)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=window.$||Backbone.$,t=function(t){function r(){return this._build_contexts=n(this._build_contexts,this),this.invalidate=n(this.invalidate,this),r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.contexts=null,r.prototype.initialize=function(){return this.contexts||(this.contexts=new Transit.Contexts),this.on("change:contexts",this._build_contexts),this._build_contexts(),this},r.prototype.invalidate=function(t,n,r){var i,s,o,u,a;if(n&&n.responseText){o=e.parseJSON(n.responseText);if(o.errors){u=o.errors,a=[];for(i in u)s=u[i],a.push(t.trigger("error:"+i,s));return a}}},r.prototype.toJSON=function(){var e,t;return e={},this.contexts.each(function(t,n){return e[n.toString()]=t.toJSON()}),t={},t[""+Transit.Contexts.build_as]=e,{page:_.extend(r.__super__.toJSON.apply(this,arguments),t)}},r.prototype._build_contexts=function(){var e;return e=this.attributes.contexts||[],this.contexts.reset(e),delete this.attributes.contexts,this},r}(Backbone.Model),Transit.Deliverable=t,typeof module!="undefined"&&module!==null&&(module.exports=Transit.Deliverable)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.build_as="contexts_attributes",t.prototype._deliverable=null,t.prototype.model=function(e){var t;return t=Transit.get("context",e._type),t!==null?new t(e):new Transit.Context(e)},t}(Backbone.Collection),Transit.Contexts=e,typeof module!="undefined"&&module!==null&&(module.exports=Transit.Contexts)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t.prototype.defaults={deliverable_id:null,deliverable_type:null,urls:[],url:null,image:!0,filename:null},t.prototype.isImage=function(){return this.get("image")},t}(Backbone.Model),t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return r(n,t),n.prototype.model=e,n.prototype.url=function(){return Transit.settings.asset_path},n.prototype.fetch=function(e){return e==null&&(e={}),e.data=this.deliverable,Backbone.Collection.prototype.fetch.apply(this,[e])},n}(Backbone.Collection),Transit.Asset=e,Transit.Assets=t,typeof module!="undefined"&&module!==null&&(module.exports={Asset:e,Assets:t})}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t}(Backbone.View),Transit.set("view","Context",e)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){return this._save=t(this._save,this),this.show=t(this.show,this),this.render=t(this.render,this),this.hide=t(this.hide,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.prototype.tagName="div",n.prototype.className="transit-ui",n.prototype.events={"click button.save":"_save"},n.prototype.toolBar=null,n.prototype.initialize=function(){return Transit.one("init",this.render)},n.prototype.append=function(e){return this.$el.append(e)},n.prototype.attach=function(e){return this.model=e,this},n.prototype.hide=function(){return this.$el.addClass("hidden"),$("html").addClass("transit-ui-hidden").removeClass("transit-ui-active"),Transit.trigger("ui:hide"),this},n.prototype.prepend=function(e){return this.$el.prepend(e)},n.prototype.render=function(){return $("#transit_ui").length===0&&(n.__super__.render.apply(this,arguments),$("html").addClass("transit-ui-hidden"),this.$el.addClass("hidden").attr("id","transit_ui").appendTo($("body")),this.toolBar===null&&(this.toolBar=Transit.Toolbar=new Transit.Toolbar,this.append(this.toolBar.$el))),this},n.prototype.show=function(){return this.$el.removeClass("hidden"),$("html").removeClass("transit-ui-hidden").addClass("transit-ui-active"),Transit.trigger("ui:show"),this},n.prototype._save=function(e){return e&&e.preventDefault(),this.model?this.model.save:!1},n}(Backbone.View),Transit.Manager=new e,typeof module!="undefined"&&module!==null&&(module.exports=Transit.Manager)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},s=[].slice;t=function(t){function r(){this.set=n(this.set,this),r.__super__.constructor.apply(this,arguments),this.$el.attr("id","transit_ui_toolbar")}return i(r,t),r.prototype.panels=[],r.prototype.tabBar=null,r.prototype.heading=null,r.prototype.tagName="div",r.prototype.className="transit-toolbar",r.prototype.initialize=function(){return r.__super__.initialize.apply(this,arguments),this.render()},r.prototype.add=function(){var e,t,n,r,i,o=this;t=1<=arguments.length?s.call(arguments,0):[],i=[];for(n=0,r=t.length;n<r;n++)e=t[n],_.indexOf(this.panels,e.cid,!0)===-1?(this.$("div.panels").append(e.render().$el),this.tabBar.append(e.cid,e.title),this.panels.push(e.cid),this.panels=_.unique(this.panels),e.on("active",function(){return o.tabBar.find(e.cid).find("a").click()}),i.push(e.on("remove",function(){return o.tabBar.remove(e.cid)}))):i.push(void 0);return i},r.prototype.render=function(){return r.__super__.render.apply(this,arguments),this.tabBar===null&&(this.tabBar=new e),this.$el.append("<h1>Title</h1>").append(this.tabBar.el).append("<div class='panels'></div>"),this.heading=this.$("h1"),this.tabBar.el.find("a:eq(0)").click(),this},r.prototype.set=function(e,t){switch(e){case"heading":this.heading.html(t);break;default:return!1}return!0},r}(Backbone.View),e=function(){function e(){this.remove=n(this.remove,this),this.prepend=n(this.prepend,this),this.make=n(this.make,this),this.insert=n(this.insert,this),this.find=n(this.find,this),this.change=n(this.change,this),this.append=n(this.append,this);var e,t,r;this.tabs={},this.el=$('      <div class="navbar">        <div class="navbar-inner">          <ul class = "transit-tab-bar nav"></ul>        </div>      </div>'),this.list=this.el.find("ul.transit-tab-bar"),r=this.tabs;for(e in r)t=r[e],this.el.append(t);this}return e.prototype.el=null,e.prototype.list=null,e.prototype.tabs={},e.prototype.append=function(){var e;return e=1<=arguments.length?s.call(arguments,0):[],this.list.append(this.make.apply(this,e))},e.prototype.change=function(e){return $("li",this.list).removeClass("active"),this.find(e)===void 0?!0:(this.find(e).addClass("active"),this)},e.prototype.find=function(e){return $(this.tabs[e])},e.prototype.insert=function(){var e,t,n;return t=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],n=this.make.apply(this,e),t<_.size(this.tabs)?this.el.append(n):this.list.find("> li").eq(t).after(n)},e.prototype.make=function(e,t,n){var r,i,s,o;n==null&&(n={}),r=$("<li></li>"),i=$("<a></a>").text(t);if(this.tabs[e]!==void 0)return this.tabs[e];for(s in n){o=n[s];switch(s){case"class":i.addClass(o);break;case"icon":i.prepend($("<i></i>").addClass("icon-"+o));break;default:i.attr(s,o)}}return i.attr({href:"#transit_panel_"+e,"data-toggle":"tab"}).text(t),r.append(i),this.tabs[e]=r,r},e.prototype.prepend=function(e,t,n){return n==null&&(n={}),this.list.prepend(this.make(e,t,n))},e.prototype.remove=function(e){return this.find(e).remove()},e}(),Transit.Toolbar=t,typeof module!="undefined"&&module!==null&&(module.exports=Transit.Toolbar)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){this.remove=t(this.remove,this),this.deactivate=t(this.deactivate,this),this.activate=t(this.activate,this),this.initialize=t(this.initialize,this);var e,r,i,s;n.__super__.constructor.apply(this,arguments),s=["title","icon"];for(r=0,i=s.length;r<i;r++)e=s[r],this.options[e]!==void 0&&(this[e]=this.options[e]);this.$el.attr("id","transit_panel_"+this.cid)}return r(n,e),n.prototype.tagName="div",n.prototype.className="transit-panel",n.prototype.title="Detail",n.prototype.icon="",n.prototype.active=!1,n.prototype.initialize=function(){},n.prototype.activate=function(){return this.active=!0,this.$el.addClass("active")},n.prototype.deactivate=function(){return this.active=!1,this.$el.removeClass("active")},n.prototype.remove=function(){return n.__super__.remove.apply(this,arguments),this.trigger("remove",this)},n}(Backbone.View),Transit.Panel=e,typeof module!="undefined"&&module!==null&&(module.exports=Transit.Panel)}.call(this)