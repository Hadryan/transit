(function(){var e,t,n,r,i,s,o,u,a,f=function(e,t){return function(){return e.apply(t,arguments)}},l=[].slice,c={}.hasOwnProperty,h=function(e,t){function r(){this.constructor=e}for(var n in t)c.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};e=this.Backbone||require("backbone"),i=this._||require("underscore"),n=null,e.Events.one=function(e,t,n){var r;return r=i.bind(function(){return this.unbind(e,r),t.apply(n||this,arguments)},this),this.bind(e,r)},a=[e.Model,e.View,e.Collection];for(o=0,u=a.length;o<u;o++)r=a[o],(s=r.prototype).one||(s.one=e.Events.one);n=function(){function e(){this.manage=f(this.manage,this),this.init=f(this.init,this),this.initializer=f(this.initializer,this),this.ui=new t}return e.prototype.VERSION="0.3.0",e.prototype.ui=null,e.prototype._initializers=[],e.prototype._cache={context:{}},e.prototype.compile=function(e){return i.template(e)},e.prototype.get=function(e,t){return this._cache[e.toLowerCase()][t]},e.prototype.initializer=function(e){return this._initializers.push(e),this},e.prototype.init=function(){var e,t=this;return this.trigger("before:initialize"),e=i.collect(this._initializers.reverse(),function(e){var t;return t=$.Deferred(),e(t.resolve),t}),$.when.apply(null,e).then(function(){return t.trigger("after:initialize"),t.trigger("ready")})},e.prototype.manage=function(e,t){var n,r=this;return this.ui.render(),n=new this.Manager({model:e}),this.ui.setView(n).render(t).then(function(){return r.ui.show()}),n},e.prototype.render=function(e,t){if(i.isString(e))return this.compile(e)(t);if(i.isFunction(e))return e(t);if(i.isObject(e))return e.template(i.extend(t,e.data),e.options)(t);throw new Error("The template "+e+" could not be rendered.")},e.prototype.runCallbacks=function(){var e,t,n,r,s,o;t=1<=arguments.length?l.call(arguments,0):[],s=i.unique(t),o=[];for(n=0,r=s.length;n<r;n++)e=s[n],this[e]?o.push(this[e]()):o.push(void 0);return o},e.prototype.set=function(e,t,n){return this._cache[e.toLowerCase()][t]=n,this},e.prototype.end=function(){return this.ui.close(),this.off(null,null,this),this},e}(),t=function(e){function t(){return this.append=f(this.append,this),t.__super__.constructor.apply(this,arguments)}return h(t,e),t.prototype.tagName="div",t.prototype.className="transit-ui",t.prototype.id="transit_ui",t.prototype.subview=null,t.prototype.rendered=!1,t.prototype.append=function(e){return this.$el.append(e)},t.prototype.close=function(){return this.subview!==null&&this.subview.close(),this.off(null,null,this),this.remove()},t.prototype.hide=function(){return this.$el.hasClass("hidden")||n.trigger("ui:hide"),this.$el.addClass("hidden"),this},t.prototype.render=function(){return this.rendered===!0?this:(this.rendered=!0,this.$el.append('<div id="transit_manager"></div>').appendTo($("body")),this)},t.prototype.setView=function(e){var t,n=this;return this.subview!==null&&typeof (t=this.subview).close=="function"&&t.close(),this.subview=e,this.subview.render().then(function(e){return n.$("#transit_manager").html(n.subview.el)}),this.subview},t.prototype.show=function(){return this.$el.hasClass("hidden")&&n.trigger("ui:show"),this.$el.removeClass("hidden"),this},t}(e.View),i.extend(n.prototype,e.Events),n=this.Transit=new n,this.Transit||(this.Transit=n),typeof module!="undefined"&&module!==null&&(module.exports=n)}).call(this),function(){var e,t,n;n=navigator.userAgent,e={msie:n.indexOf("MSIE")!==-1&&n.indexOf("Opera")===-1,gecko:n.indexOf("Gecko")!==-1&&n.indexOf("KHTML")===-1,webkit:n.indexOf("AppleWebKit/")!==-1,chrome:n.indexOf("Chrome/")!==-1,opera:n.indexOf("Opera/")!==-1,ios:/ipad|iphone|ipod/i.test(n),android:/android (\d+)/i.test(n)},t=this.Transit||require("transit"),t.browser=e,typeof module!="undefined"&&module!==null&&(module.exports=e)}.call(this),function(){var e,t;t=this.Transit||require("transit"),e=function(){function e(){_.bindAll(this)}return e.prototype.selection=null,e.prototype.cursor=function(){var e,t,n,r;return r=this.get(),r===null?null:(e=$("<span/>"),t=document.createRange(),t.setStart(r.endContainer,r.endOffset),t.insertNode(e.get(0)),n=e.offset(),e.remove(),n)},e.prototype.get=function(){var e,t;return t=null,window.getSelection?(e=window.getSelection(),t=e.rangeCount>0?e.getRangeAt(0):null):document.selection&&document.selection.createRange&&(t=document.selection.createRange()),t},e.prototype.restore=function(e){var t;return e==null&&(e=null),e===null&&(e=this.selection),e===null?!0:(window.getSelection?(t=window.getSelection(),t.removeAllRanges(),t.addRange(e)):document.selection&&e.select&&e.select(),this.selection=null,this)},e.prototype.save=function(){return this.selection=this.get(),this.selection},e}(),t.Selection=this.Transit.Selection=new e,typeof module!="undefined"&&module!==null&&(module.exports=t.Selection)}.call(this),function(){var e,t,n,r=[].slice;t=this.Transit||require("transit"),n=this._||require("underscore"),e=function(){function e(){}return e.prototype.cache={},e.prototype.get=function(e){var r=this;return $.Deferred(function(i){var s;e||(e="");if(r.cache[e])return i.resolve(r.cache[e]);if(n.isFunction(s))return r.cache[e]=s,i.resolve(s);s=$("[data-template-name='"+e+"']");if(s.length===0){if(/\//.test(s))return $.get(e,function(n){return r.cache[e]=t.compile(n),i.resolve(r.cache[e])});r.cache[e]=t.compile(e)}else r.cache[e]=t.compile(s.html());return i.resolve(r.cache[e])}).promise()},e.prototype.set=function(e,t){},e.prototype.clear=function(){var e,t,n,i,s;t=1<=arguments.length?r.call(arguments,0):[],s=[];for(n=0,i=t.length;n<i;n++)e=t[n],s.push(delete this.cache[e]);return s},e}(),t.TemplateCache=new e,typeof module!="undefined"&&module!==null&&(module.exports=t.TemplateCache)}.call(this),function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}},i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},o=[].slice;e=this.Backbone||require("backbone"),t=this.Transit||require("transit"),n=this._||require("underscore"),t.View=function(e){function i(){this.release=r(this.release,this),this.detach=r(this.detach,this);var e,s,o,u,a,f,l,c,h,p;t.runCallbacks.call(this,"beforeInitialize"),i.__super__.constructor.apply(this,arguments),u={},h=this.subviews;for(e=l=0,c=h.length;l<c;e=++l)o=h[e],f=new e,f.container=this.$el,u[f.cid]=f;p=this.options;for(s in p)a=p[s],n.has(this,s)&&a&&(this[s]=a);n.has(this.options,"template")&&(this.template=this.options.template),this.subviews=u}return s(i,e),i.prototype.tagName="div",i.prototype.bindings={},i.prototype.container=null,i.prototype.containerMethod="html",i.prototype.closed=!1,i.prototype.helpers={},i.prototype.keep=!1,i.prototype.manager=null,i.prototype.subviews={},i.prototype.template=null,i.prototype.wrapper=!0,i.prototype.add=function(){var e,t,n,r;t=1<=arguments.length?o.call(arguments,0):[],this.release(t);for(n=0,r=t.length;n<r;n++)e=t[n],this.$el.append(e.$el),this.subviews[e.cid]=e,e.manager=this;return t.length===1?t[0]:t},i.prototype.close=function(e){var n,r,i,s,o,u,a;if(this.closed)return typeof e=="function"&&e(),this;u=this.subviews;for(n in u)i=u[n],i.close();t.runCallbacks.call(this,"beforeClose","beforeRemove"),this.$el.off(".transit"),this.keep!==!0&&this.remove(),this.manager!==null&&this.manager.release(this),this.closed=!0,this._unbindNodes(),this.trigger("close"),a=[this.model,this.collection,t];for(s=0,o=a.length;s<o;s++)r=a[s],r&&r.off(null,null,this);return this.getViews().each(function(e){return e.close()}),this.model=null,this.collection=null,t.runCallbacks.call(this,"afterRemove","afterClose"),this.trigger("closed"),this.off(null,null,this),typeof e=="function"&&e(),this},i.prototype.compile=function(){var e,r,i=this;return r=$.Deferred(),this.template===null?(e="",this.wrapper=!0,r.resolveWith(this,[e])):n.isFunction(this.template)?r.resolveWith(this,[this.template]):t.TemplateCache.get(this.template).then(function(e){return r.resolveWith(i,[e])}),r.promise()},i.prototype.detach=function(){return this.$el.detach(),this},i.prototype.getViews=function(e){var t;return t=n.chain(n.values(this.subviews)).map(function(e){return[].concat(e)},this).flatten(),typeof e=="function"&&e(t.values()),t},i.prototype.prepend=function(){var e,t,n,r;t=1<=arguments.length?o.call(arguments,0):[],this.add(t);for(n=0,r=t.length;n<r;n++)e=t[n],e.$el.detach().prependTo(this.$el);return t.length===1?t[0]:t},i.prototype.release=function(){var e,t,n,r;t=1<=arguments.length?o.call(arguments,0):[];for(n=0,r=t.length;n<r;n++)e=t[n],this.subviews[e.cid]=null,delete this.subviews[e.cid],$.contains(this.$el.get(0),$(e.el).get(0))&&e.keep===!1&&e.detach();return t.length===1?t[0]:t},i.prototype.render=function(e){var n,r=this;return this.closed=!1,n=$.Deferred(),this.compile().then(function(i){var s;return s=t.render(i,r.serialize()),r.trigger("render"),t.runCallbacks.call(r,"beforeRender"),r.wrapper===!0?r.$el.html(s):s!==void 0&&r.setElement($(s)),r.container!==null&&$.fn[r.containerMethod].call($(r.container),r.$el),t.runCallbacks.call(r,"afterRender"),r._bindNodes(),r.trigger("rendered"),typeof e=="function"&&e(),n.resolveWith(r,[r.el])}),n.promise()},i.prototype.serialize=function(){var e,t;return e={},this.model&&(e=n.extend(e,this.model.toJSON())),this.collection&&(e=n.extend(e,{items:this.collection.toJSON()})),t=n.isFunction(this.helpers)?this.helpers.call(this):this.helpers,n.extend(t,e)},i.prototype._bindNodes=function(){var e,t,n,r,i,s,o;if(!this.model)return this;s=this.bindings,o=[];for(i in s)e=s[i],r=this.$(i),t=r.is("input, textarea, select")?"change.transit":"blur.transit",n=this.model,o.push(this.$el.on(t,i,function(){var t;return t={},t[e]=r.val(),n.set(t,{silent:!0})}));return o},i.prototype._unbindNodes=function(){var e,t,r,i,s;i=n.keys(this.bindings),s=[];for(t=0,r=i.length;t<r;t++)e=i[t],s.push(this.$(e).off(".transit"));return s},i}(e.View),typeof module!="undefined"&&module!==null&&(module.exports=t.View)}.call(this),function(){var e,t,n,r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},u=[].slice;n=this.Transit||require("transit"),e=this.Backbone||require("backbone"),r=this._||require("underscore"),n.Manager=function(e){function s(){return this.add=i(this.add,this),s.__super__.constructor.apply(this,arguments)}return o(s,e),s.prototype.tagName="div",s.prototype.className="transit-manager",s.prototype.events={"click button.save":"save"},s.prototype.initialize=function(){return this.panels||(this.panels=new n.Manager.Panels),this.navbar||(this.navbar=new n.Manager.Navbar)},s.prototype.helpers=function(){return{heading:"Manage "+this.model.type}},s.prototype.add=function(){var e,n,i,s,o,a,f;i=1<=arguments.length?u.call(arguments,0):[],e=this.model;for(a=0,f=i.length;a<f;a++)n=i[a],r.isUndefined(n.model)&&(n.model=e),s=new t({title:n.title,icon:n.icon}),s.panel=n.cid,n._tab=s,o=this.panels,s.on("activate",function(){var e;return e=this.panel,o.show(),o.getViews().each(function(t){return t.cid===e?(t.$el.addClass("active"),typeof t.active=="function"?t.active():void 0):(t.$el.removeClass("active"),t._tab.$el.removeClass("active"))})}),n.on("inactive",function(){return o.hide(),o.getViews().each(function(e){return e.$el.removeClass("active"),e._tab.$el.removeClass("active")})}),this.navbar.add(s).render(),this.panels.add(n).render();return i.length===1?i[0]:i},s.prototype.beforeClose=function(){return this.panels.close(),this.navbar.close()},s.prototype.afterRender=function(){return this.panels.setElement(this.$("div.panels:eq(0)")).render(),this.navbar.setElement(this.$("ul.transit-nav-bar")).render()},s.prototype.prepend=function(){var e,t,n,r;t=1<=arguments.length?u.call(arguments,0):[],this.add.apply(this,t);for(n=0,r=t.length;n<r;n++)e=t[n],e.$el.detach().prependTo(this.panels.$el),e._tab.$el.detach().prependTo(this.navbar.$el);return t.length===1?t[0]:t},s.prototype.save=function(){return this.trigger("before:save"),this.model.save(),this.trigger("after:save"),this},s.prototype.release=function(){var e,t,n,r;t=1<=arguments.length?u.call(arguments,0):[];for(n=0,r=t.length;n<r;n++)e=t[n],e._tab&&e._tab.close(),e.close();return t.length===1?t[0]:t},s.prototype.reset=function(e){return this.panels.close(),this.navbar.close(),typeof e=="function"&&e(),this},s}(n.View),t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.tagName="li",t.prototype.template="{{> transit_navbar_tab}}",t.prototype.panel=null,t.prototype.events={"click a":"activate"},t.prototype.activate=function(e){return e&&e.preventDefault(),this.$el.addClass("active"),this.trigger("activate")},t.prototype.beforeClose=function(){return this.panel=null},t.prototype.serialize=function(){var e,n,i,s;e=t.__super__.serialize.apply(this,arguments),e=r.defaults(t.__super__.serialize.apply(this,arguments),{title:"Tab"}),e.css=r.compact(r.flatten([e.css])),i=r.pick(this.options,"class","icon","title");for(n in i){s=i[n];switch(n){case"class":e.css.push(s);break;case"title":e.title=s;break;case"icon":s!==""&&(e.icon=$("<i></i>").addClass("icon-"+s)+"")}}return e},t.prototype.afterRender=function(){return this.$el.attr("rel",this.panel)},t}(n.View),n.Manager.Panels=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.tagName="div",t.prototype.className="panels",t.prototype.wrapper=!1,t.prototype.events={"click span.close":"deactivate"},t.prototype.show=function(){return this.$("span.close").show()},t.prototype.hide=function(){return this.$("span.close").hide()},t.prototype.afterRender=function(){if(!(this.$("span.close").length>0))return this.$el.append("<span class='close'>&times;</span>"),this.$("span.close").hide()},t.prototype.deactivate=function(){return this.getViews().each(function(e){if(e.$el.hasClass("active"))return e.trigger("inactive"),typeof e.inactive=="function"?e.inactive():void 0}),this},t}(n.View),n.Manager.Navbar=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.template=function(){},t.prototype.wrapper=!1,t}(n.View),typeof module!="undefined"&&module!==null&&(module.exports=n.Manager)}.call(this),function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}},i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=this.Transit||require("transit"),e=this.Backbone||require("backbone"),n=this._||require("underscore"),t.Modal=function(e){function i(){return this.perform=r(this.perform,this),i.__super__.constructor.apply(this,arguments)}return s(i,e),i.prototype.className="transit-modal",i.prototype.events={"click a[data-action],button[data-action]":"perform"},i.prototype.container="#transit_ui",i.prototype.containerMethod="append",i.prototype.wrapper=!1,i.prototype.afterRender=function(){return this.$el.attr("id","transit_modal_"+this.cid).addClass("out"),this.handler.call(this,!0),this.$el.removeClass("out").addClass("in")},i.prototype.handler=function(e){var n=this;return e===!0?this.$el.modal({show:!0}).one("hidden",function(e){return t.trigger("modal:close",n),n.close()}):this.$el.modal("hide"),this},i.prototype.initialize=function(){return i.__super__.initialize.apply(this,arguments),this.options=n.defaults(this.options,{buttons:[],title:"Title Missing",content:"Content missing"})},i.prototype.perform=function(e){var n,r;return e.preventDefault(),r=$(e.currentTarget),n=r.attr("data-action"),t.trigger("modal:action",n,this),this.trigger("modal:action",n,this),n==="close"&&this.handler.call(this,!1),this},i.prototype.serialize=function(){return n.extend(i.__super__.serialize.apply(this,arguments),this.options)},i}(t.View),t.modal=function(e){var n;return e==null&&(e={}),n=new t.Modal(e),t.one("modal:show",function(e){if(e!==n)return!1}),n.render(),n},typeof exports!="undefined"&&exports!==null&&(exports.modal=t.modal),typeof module!="undefined"&&module!==null&&(module.exports=t.Modal)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=this.Transit||require("transit"),e.Notify=function(){function n(){this.render=t(this.render,this),this.success=t(this.success,this),this.info=t(this.info,this),this.error=t(this.error,this)}return n.prototype.error=function(e){return this.render(e,"error")},n.prototype.info=function(e){return this.render(e,"info")},n.prototype.success=function(e){return this.render(e,"success")},n.prototype.render=function(t,n){return e.ui.append($(this.template({message:t,type:n})))},n}(),e.notify=function(t,n){var r;return r=new e.Notify,r[t](n),this},typeof exports!="undefined"&&exports!==null&&(exports.notify=e.notify),typeof module!="undefined"&&module!==null&&(module.exports=e.Notify)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=this.Transit||require("transit"),e.Panel=function(e){function t(){var e,n,r,i;t.__super__.constructor.apply(this,arguments),i=["title","icon","template"];for(n=0,r=i.length;n<r;n++)e=i[n],this.options[e]!==void 0&&(this[e]=this.options[e]);this.$el.attr("id")===void 0&&this.$el.attr("id","transit_panel_"+this.cid),this.$el.attr("rel",this.cid)}return n(t,e),t.prototype.className="transit-panel",t.prototype.title="Detail",t.prototype.icon="",t.prototype._tab=null,t.prototype.template=function(){return""},t}(e.View),typeof module!="undefined"&&module!==null&&(module.exports=e.Panel)}.call(this),function(){var e,t,n,r,i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=this.Transit||require("transit"),e=this.Backbone||require("backbone"),n=function(){var e;return XMLHttpRequest===void 0?!1:(e=new XMLHttpRequest,e.upload===void 0?!1:e.upload.onprogress!==void 0)},r=function(){var e;return e=document.createElement("INPUT"),e.type="file",e.files!==void 0},t.Uploader=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return s(t,e),t.prototype.tagName="div",t.prototype.className="transit-uploader",t["native"]=n(),t}(t.View),typeof module!="undefined"&&module!==null&&(module.exports=t.Uploader)}.call(this),function(){var e,t,n,r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t=this.Transit||require("transit"),e=this.Backbone||require("backbone"),n=this._||require("underscore"),t.Form=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.className="transit-form transit-panel",t.prototype.events={"change [data-binding]":"update","blur [data-binding]":"update"},t.prototype.afterRender=function(){var e,t,n,r,i=this;n=this.model.attributes,r=[];for(e in n)t=n[e],r.push(this.$("[data-binding='"+e+"']").each(function(e,n){return n=$(n),n.is(":input")?n.val(t):n.html(t)}));return r},t.prototype.update=function(e){var t,n,r;if(e&&e.currentTarget)return t=$(e.currentTarget),r=t.val(),n=e.type==="blur"?{silent:!0}:{},this.model.set(t.data("binding"),r,n),this},t}(t.Panel),typeof module!="undefined"&&module!==null&&(module.exports=t.Form)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t=this.Transit||require("transit"),e=this.Backbone||require("backbone"),t.Asset=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t.prototype.defaults={urls:[],url:null,filename:null},t}(e.Model),t.Asset.Image=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t.prototype.image=!0,t.prototype.defaults={_type:"image"},t}(t.Asset),t.Asset.File=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t.prototype.image=!1,t.prototype.defaults={_type:"file"},t}(t.Asset),typeof module!="undefined"&&module!==null&&(module.exports=t.Asset)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t=this.Transit||require("transit"),e=this.Backbone||require("backbone"),t.Assets=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return r(n,e),n.prototype.model=function(e){var n;return n=e._type==="image"?t.Asset.Image:t.Asset.File,delete e._type,new n(e)},n.prototype.url=function(){return t.settings.asset_path},n}(e.Collection),typeof module!="undefined"&&module!==null&&(module.exports=t.Assets)}.call(this),function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}},i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};e=this.Backbone||require("backbone"),n=this._||require("underscore"),t=this.Transit||require("transit"),t.Context=function(e){function n(){this._view_options=r(this._view_options,this);var e;t.runCallbacks.call(this,"before:initialize"),n.__super__.constructor.apply(this,arguments),this._setType(),e=this.view,e===null&&(e=t.ContextView),this.view=new e(this._view_options()),this._bindView()}return s(n,e),n.prototype.type="Context",n.prototype.deliverable=null,n.prototype.defaults={_type:null,position:null},n.prototype.view=null,n.prototype._destroyed=!1,n.prototype.destroy=function(){return this.isNew()?n.__super__.destroy.apply(this,arguments):this._destroyed=!0,this},n.prototype.toJSON=function(){var e;return e=n.__super__.toJSON.apply(this,arguments),this._destroyed&&(e._destroy=!0),e},n.prototype._setType=function(){var e;if(this.type!==null&&this.type!==void 0)return this;e=this.get("_type");if(e===null||e===void 0)throw new Error("Contexts must declare a 'type' attribute.");return this.type=e},n.prototype._bindView=function(){return this.on("change",function(e){if(this.view)return this.view.trigger("update")})},n.prototype._view_options=function(){var e;return e={model:this},this.isNew()||(e.el="[data-context-id='"+this.id+"']"),e},n}(e.Model),typeof module!="undefined"&&module!==null&&(module.exports=t.Context)}.call(this),function(){var e,t,n,r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=this.Backbone||require("backbone"),n=this._||require("underscore"),t=this.Transit||require("transit"),t.Contexts=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return i(n,e),n.build_as="contexts_attributes",n.prototype.comparator=function(e){return parseInt(e.get("position"))},n.prototype.model=function(e){var n;n=t.get("context",e._type);if(n===null||n===void 0)n=t.Context;return new n(e)},n}(e.Collection),typeof module!="undefined"&&module!==null&&(module.exports=t.Contexts)}.call(this),function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}},i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=this.Transit||require("transit"),e=this.Backbone||require("backbone"),n=this._||require("underscore"),t.Deliverable=function(e){function i(){return this._view_options=r(this._view_options,this),this._build_contexts=r(this._build_contexts,this),this.invalidate=r(this.invalidate,this),i.__super__.constructor.apply(this,arguments)}return s(i,e),i.prototype.contexts=null,i.prototype.type=null,i.prototype.view=null,i.prototype.initialize=function(){var e=this;return this.type===null&&(this.type=this.constructor.name),this.contexts||(this.contexts=new t.Contexts),this.view||(this.view=new t.Region(this._view_options())),this.on("change:contexts",this._build_contexts),this.contexts.on("add",function(t){return e.view.add(t.view).render()}),this.contexts.on("remove",function(t){var n,r;return(n=t.view)!=null&&(n.keep=!1),t.view&&e.view.release(t.view),(r=t.view)!=null?r.close():void 0}),this._build_contexts(),this},i.prototype.invalidate=function(e,t,n){var r,i,s,o,u;if(t&&t.responseText){s=$.parseJSON(t.responseText);if(s.errors){o=s.errors,u=[];for(r in o)i=o[r],u.push(e.trigger("error:"+r,i));return u}}},i.prototype.toJSON=function(){var e,r,s;return e={},this.contexts.each(function(t,n){return e[n.toString()]=t.toJSON()}),r={},r[""+t.Contexts.build_as]=e,s={},s[(this.type||this.get("_type")).toLowerCase()]=n.extend(i.__super__.toJSON.apply(this,arguments),r),s},i.prototype._build_contexts=function(){var e,t;return e=this.attributes.contexts||[],this.contexts.reset(e),this.unset("contexts",{silent:!0}),(t=this.view)!=null&&t.update(),this},i.prototype._view_options=function(){var e;return e={model:this},this.isNew()||(e.el="[data-deliverable-id='"+this.id+"']"),e},i}(e.Model),typeof module!="undefined"&&module!==null&&(module.exports=t.Deliverable)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=this.Transit||require("transit"),e.AssetManager=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.title="Assets",t.prototype.className="transit-panel transit-asset-manager",t.prototype.initialize=function(){return this.render()},t}(e.Panel),typeof module!="undefined"&&module!==null&&(module.exports=e.AssetManager)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=this.Backbone||require("backbone"),t=this.Transit||require("transit"),t.ContextView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t.prototype.tagName="div",t.prototype.className="context managed-context",t.prototype.keep=!0,t.prototype.template=function(){return""},t.prototype.beforeRender=function(){if(!this.model.isNew())return this.wrapper=!1},t.prototype.afterRender=function(){return this.$el.attr("data-context-id")||this.$el.attr("data-context-id",this.model.id),this.$el.attr("data-context-type")||this.$el.attr("data-context-type",this.model.type),this.wrapper=!0,this},t.prototype.beforeClose=function(){if(this.model.isNew())return this.keep=!1},t.prototype.afterClose=function(){return this.keep=!0},t}(t.View),typeof module!="undefined"&&module!==null&&(module.exports=t.ContextView)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=this.Transit||require("transit"),e.Region=function(e){function n(){return this.afterRender=t(this.afterRender,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.prototype.tagName="div",n.prototype.className="region",n.prototype.keep=!0,n.prototype.initialize=function(){},n.prototype.beforeRender=function(){if(!this.model.isNew())return this.wrapper=!1},n.prototype.afterRender=function(){return this.$el.attr("data-deliverable-id",this.model.id).attr("data-deliverable-type",this.model.type),this.wrapper=!0,this.update()},n.prototype.update=function(){var e=this;return this.model.contexts.each(function(t){e.release(t.view),e.add(t.view);if(t.isNew())return t.view.render()})},n}(e.View),typeof module!="undefined"&&module!==null&&(module.exports=e.Region)}.call(this)